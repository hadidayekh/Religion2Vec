<!doctype html>
<html lang="en">
<script src="https://code.highcharts.com/highcharts.js"></script>
<style>
.tool {
  position: relative;
  display: inline-block;
  border-bottom: 1px dotted black;
  font-style: italic;
}

.tool .tooltext {
  visibility: hidden;
  width: 120px;
  background: rgba(248,248,248, 0.8);
  text-align: center;
  border-radius: 6px;
  padding: 5px;
  position: absolute;
  z-index: 1;
}

.tool:hover .tooltext {
  visibility: visible;
}

.big{
	margin-top: 1em;
	margin-left: 10em;
	
}

.text-line {
	text-align: center;
    color: #eeeeee;
    outline: none;
    outline-style: none;
    border-top: none;
    border-left: none;
    border-right: none;
    border-bottom: solid #000000 2px;
}

input[type="word"] {
	color: #000000;
	width: 100px;
}

output[type="word"]{
	font-size: 22px;
	color: #000000;
	width: 150px;
	opacity: 0.7;
}

.text{
	font-weight: bold; 
	font-size: 18px;
	font-family: sans-serif;
}
#page-container {
  position: relative;
  min-height: 100vh;
}
#content-wrap {
  padding-bottom: 71px;
}

</style>

<script type="text/javascript" src="data_bible\woman.json"></script>
<script type="text/javascript" src="data_bible\knowledge.json"></script>
<script type="text/javascript" src="data_bible\heaven.json"></script>	
<script type="text/javascript" src="data_bible\hell.json"></script>	
 
 <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">  
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://code.highcharts.com/modules/exporting.js"></script>
    <title>Bible</title>
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <a class="navbar-brand" href="#" style="font-size: 30px"><b>Religion2Vec</b></a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav" style="font-size: 20px">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="./page.html">Home</a>
      </li>
      <li class="nav-item active">
        <a class="nav-link" href="#">Bible<span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="./quran.html">Quran</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="./torah.html">Torah</a>
      </li>
    </ul>
  </div>
</nav>
  </head>
  
<body>
<div id="page-container">
<div id="content-wrap">
<div style="padding-top: 20px; margin-left: 10em; width: 75%">
 <h2>
    The Bible
    <small class="text-muted">some team notes</small>
</h2>
</div>
<blockquote class="blockquote text-center" style="padding-top: 10px; margin-left: 10em; width: 75%">
  <p class="mb-0">The following are visualizations of some of the exciting findings that we collected while applying word embeddings on the three religious books. It is interesting to note how some integral religious terms and concepts that are shared between these religions are different in their conceptual meanings. This page is dedicated to such findings in the Bible. We can see some keywords with their most closely related terms. As is evident, the term 'Woman' correlates mostly with negative terms. 'Knowledge' is closely related to both godliness and folly. 'Heaven' and 'Hell' are two concepts that are interesting to compare across books.</p>
  <footer class="blockquote-footer">Observations from your <cite title="Source Title">FYP Team</cite></footer>
</blockquote>


 <div class="big">
 <h2>
    Some interesting findings
    <small class="text-muted">closely related words</small>
</h2>

 <div  id="bible" name='bible'>
	
</div>
	</div>
	<div style="margin-left: 10em; width: 75%; margin-bottom: 5em;">
		<h2>
		Top words
		<small class="text-muted"> in terms of occurences</small>
		</h2>
	</div>
	
	<div  id="occurences" style="margin-left: 12em; width: 75%;"></div>
	</br></br>
	<div class="card" style="margin-left: 15em; width: 70%">
 <div class="card-header">
    <h2>
    <span class="text" style = "font-size: 30px">Try it yourself!</span> 
    <small class="text-muted">Find out relationships between words</small>
	</h2>
  </div>
  <div class="card-body">
    <blockquote class="blockquote text-center" style="padding-right: 170px">
	<p class="mb-0">This is an example of algebraic operations on words made possible thanks to word embedding. </p>
	</blockquote>
		  <div class="form-inline" style="padding-top: 30px; margin-left: 4em">
		
		<input type="word" class="text-line" id="word" placeholder="Enter word" name="word">
		<span class="text">&nbsp;is related to &nbsp;</span>
		<input class="text-line" type="word" id="relatedTo" name="relatedTo" placeholder=" word">
		<span class="text">&nbsp; as &nbsp; </span>
		<span class="text"> <span class="text-muted" style="outline-style: none; border-top: none; font-style: italic; border-left: none; border-right: none">&nbsp;[some word]&nbsp;</span> is related to &nbsp; </span>
		<input class="text-line" type="word" id="word2" name="word2" placeholder=" word">
		<button type="button" id = "submit" class="btn btn-primary" onclick="getAnswer()" style = "font-size:20px; margin-left: 2em">Submit</button>
		&nbsp; &nbsp; &nbsp;
	  </div>
  </div>
	</div>
	</br></br>
	<div class="card" style="margin-left: 15em; width: 70%">
 <div class="card-header">
    <h2>
    <span class="text" style = "font-size: 30px">Results</span> 
	</h2>
  </div>
  <div class="card-body" id="results-body">
  </div>
	</div>
	</br></br></br></br>

<script>

var testWidth = window.innerWidth/2.5;
var UI = {
	showToast: (text, colorClass, options) => {
	// options are optional
	var opts = options || {};
	// setup some defaults
	opts.defaultText = opts.defaultText || 'default text';
	opts.displayTime = opts.displayTime || 3000;
	opts.target = opts.target || 'body';

	$('<div/>')
		.addClass('toast')
		//.addClass(colorClass)
		.css({
			'font-size': '20px',
			'z-index': '10000',
			'padding': '15px 20px',
			'color': '#fff',
			'border-radius': '20px',
			'background-color': 'rgba(223, 83, 83, .9)',
			'display': 'inline-block',
			'position': 'fixed',
			'top': '-100px',
			'right': '15px',
			'opacity': '0',
			'transition': 'all 0.6s ease-out',
		})
		.prependTo($(opts.target))
		.text(text || opts.defaultText)
		.queue(function(next) {
			$(this).css({
					'opacity': 1
			});
			var topOffset = 150;
			$('.toast').each(function() {
				var $this = $(this);
				var height = $this.outerHeight();
				var offset = 15;
				$this.css('top', topOffset + 'px');

				topOffset += height + offset;
			});
			next();
		})
		.delay(opts.displayTime)
		.queue(function(next) {
			var $this = $(this);
			var width = $this.outerWidth() + 20;
			$this.css({
				'right': '-' + width + 'px',
				'opacity': 0
			});
			next();
		})
		.delay(600)
		.queue(function(next) {
			$(this).remove();
			next();
		});
	}
};


function mostOccurences(some_id){
	Highcharts.chart(some_id, {
	  chart: {
		type: 'column'
	  },
	  title: {
		text: 'The words with the most occurences'
	  },
	  subtitle: {
		text: 'excluding stop-words'
	  },
	  xAxis: {
		categories: [
		  'Lord',
		  'God',
		  'Man',
		  'Israel',
		  'King',
		  'Son',
		  'People',
		  'House',
		  'Children',
		  'Day'
		],
		crosshair: true
	  },
	  yAxis: {
		min: 0,
		title: {
		  text: ''
		}
	  },
	  tooltip: {
		headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
		pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
		  '<td style="padding:0"><b> {point.y}</b></td></tr>',
		footerFormat: '</table>',
		shared: true,
		useHTML: true
	  },
	  plotOptions: {
		column: {
		  pointPadding: 0,
		  borderWidth: 0,
		  groupPadding: 0.05,
		  shadow: false
		}
	  },
	  series: [{
		name: 'Word Count',
		data: [7964, 4472, 2735, 2575, 2541, 2392, 2143, 2024, 1821, 1743],
		color: 'rgba(223, 83, 83, .5)'
	  }]
	});

}

function drawGraph(word, json_name, book) {

	var maindivbible = document.getElementById('bible');
	var bid = "biblechart" + Math.random().toString(36).substring(7);
	var chartbib = document.createElement("DIV");
	chartbib.setAttribute("style", "height: 450px; width: "+testWidth+"px; margin-top:1.5em;"+"display: inline; float: left; padding-right: 5em");
	chartbib.id = bid;
	maindivbible.appendChild(chartbib);
	var result = JSON.parse(json_name);
	var similarnb = result.length-1;
	console.log('result',result);
	var chartJson = {
		chart: {
			type: 'scatter',
			zoomType: 'xy'
		},
		title: {
			text: "<b>"+ word.toUpperCase() +"</b>"
		},
		subtitle: {
			text: 'Showing the most similar words to <b>' + word + '</b>'
		},
		xAxis: {
			title: {
				enabled: true,
				text: 'x'
			},
			startOnTick: true,
			endOnTick: true,
			showLastLabel: true
		},
		yAxis: {
			title: {
				text: 'y'
			}
		},
		plotOptions: {
			scatter: {
				marker: {
					radius: 5,
					states: {
						hover: {
							enabled: true,
							lineColor: 'rgb(100,100,100)'
						}
					}
				},
				states: {
					hover: {
						marker: {
							enabled: false
						}
					}
				},
				tooltip: {
					headerFormat: '<b>{series.name}</b><br>',
					pointFormat: '<i>x: </i>{point.x_rounded}<br><i>y:     </i>{point.y_rounded}<br><i>similarity:   </i>{point.sim_score}<br><i>word count:   </i>{point.word_count}'
				},
				dataLabels: {
					format: "{point.name}",
					enabled: true
				},
			}
		},
		series: [{
			name: word,
			marker: {
				symbol: 'circle'
			},
			color: 'rgba(0, 0, 83, 1)',
			data: [{
				name: word,
				x: result[similarnb]['x'],
				y: result[similarnb]['y'],
				x_rounded: Math.round(result[similarnb]['x'], 2),
				y_rounded: Math.round(result[similarnb]['y'], 2),
				sim_score: 1.0,
				word_count: result[similarnb]['word_count']
			}]
		}],
		navigation: {
			menuStyle: {
				border: '1px solid #A0A0A0',
				background: '#FFFFFF',
				padding: '5px 0'
			},
			menuItemStyle: {
				padding: '0 10px',
				background: null,
				color: '#303030',
				fontSize: '16px'
			}
		},
		exporting: {
			buttons: {
				contextButton: {
					menuItems: ["viewFullscreen", "printChart", "separator", "downloadPNG", "downloadJPEG", "downloadPDF", "downloadSVG"]
				}
				}
			}
	};
	var w;
	var x;
	var y;
	var s;
	for (var i = 0; i < similarnb; i++) {
		w = result[i]['word'];
		x = result[i]['x'];
		y = result[i]['y'];
		s = result[i]['sim_score'];
		count = result[i]['word_count'];
		chartJson.series[i + 1] = {
			name: w,
			marker: {
				symbol: 'circle'
			},
			color: 'rgba(223, 83, 83, .5)',
			data: [{
				name: w,
				x: x,
				y: y,
				x_rounded: Math.round(x, 2),
				y_rounded: Math.round(y, 2),
				sim_score: s,
				word_count: count
			}]
		};
	}
	
	Highcharts.chart(bid, chartJson);
			
}		
</script>
  
	 <script type="text/javascript"> drawGraph('woman', woman, 'bible');</script >
	 <script type="text/javascript"> drawGraph('knowledge', knowledge, 'bible');</script >
	 <script type="text/javascript"> drawGraph('heaven', heaven, 'bible');</script >
	 <script type="text/javascript"> drawGraph('hell', hell, 'bible');</script >
	 <script type="text/javascript"> mostOccurences('occurences');</script >


<script>

	var word1 = document.getElementById("word");
	var word2 = document.getElementById("word2");
	var word3 = document.getElementById("relatedTo");
	word1.addEventListener("keyup", function(event) {
	  if (event.keyCode === 13) {
	   event.preventDefault();
	   document.getElementById("submit").click();
	  }
	});
	word2.addEventListener("keyup", function(event) {
	  if (event.keyCode === 13) {
	   event.preventDefault();
	   document.getElementById("submit").click();
	  }
	});
	word3.addEventListener("keyup", function(event) {
	  if (event.keyCode === 13) {
	   event.preventDefault();
	   document.getElementById("submit").click();
	  }
	});
 
var word;
var relatedTo;
var word2;
var result_bible;
function getAnswer(){
	$('#submit').attr("disabled", true);
	$("#submit").html('Loading...');
	word = (document.getElementById("word").value).toLowerCase();
	relatedTo = (document.getElementById("relatedTo").value).toLowerCase();
	word2 = (document.getElementById("word2").value).toLowerCase();
	var result = document.createElement("DIV");
	result.setAttribute("style", "height: 450px; width: 450; margin-top: 1.5em;");
	var xhttp_bible = new XMLHttpRequest();
	xhttp_bible.onreadystatechange = function() {
		if (this.readyState == 4 && this.status == 200) {
			result_bible = this.responseText;
			if(result_bible.trim() == 'absent'){
				UI.showToast("One or more words do not exist in Bible.");
			}else{
				var fields = result_bible.split(',');
				fields[0] = fields[0].substring(2,fields[0].length-1);
				fields[4] = fields[4].substring(2,fields[4].length-3);
				for(var i =1; i<4; i++){
					fields[i] = fields[i].substring(2, fields[i].length-1);
				}
				
				
				word = word.charAt(0).toUpperCase()+word.slice(1);
			
				var paragraph = document.createElement("p");
				
				var hover = document.createElement("p");
				hover.textContent = fields[0];
				hover.setAttribute("class", "tool");
				
				var span = document.createElement("span");
				
				var field1 = document.createElement("p");
				field1.textContent = fields[1];
				var field2 = document.createElement("p");
				field2.textContent = fields[2];
				var field3 = document.createElement("p");
				field3.textContent = fields[3];
				var field4 = document.createElement("p");
				field4.textContent = fields[4];
				
				span.setAttribute("class", "tooltext");
				span.style.fontStyle = "normal";
				span.appendChild(field1);
				span.appendChild(field2);
				span.appendChild(field3);
				span.appendChild(field4);
				hover.appendChild(span);
				
				var result = "- " + word +" is related to " + relatedTo+ " as ";
				var text = document.createTextNode(result);
				
				paragraph.appendChild(text);
				paragraph.appendChild(hover);
				
				result = " is related to " + word2;
				text = document.createTextNode(result);
				paragraph.appendChild(text);
				
				var element = document.getElementById("results-body");
				element.appendChild(paragraph);
			}	
			$('#submit').attr("disabled", false);
			$("#submit").html('Submit');
		}
	};
	if(word.trim() == '' || relatedTo.trim() == '' || word2.trim() == '') {
		UI.showToast("Please enter a word in each of the fields!");
		$('#submit').attr("disabled", false);
		$("#submit").html('Submit');
	} else {
		xhttp_bible.open("GET", "bookSimDiff.php?book=bible&word=" + word + "&sim=" + relatedTo + "&word2=" + word2, true);
		xhttp_bible.send();
	}
}
</script>
</div>
<footer class="footer"style="background-color:#F8F8F8; position:absolute; bottom:0; width:100%; height: 71px;"></footer>
</div>
</body>

</html>
